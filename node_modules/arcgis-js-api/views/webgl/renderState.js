// COPYRIGHT Â© 2018 Esri
//
// All rights reserved under the copyright laws of the United States
// and applicable international laws, treaties, and conventions.
//
// This material is licensed for use under the Esri Master License
// Agreement (MLA), and is bound by the terms of that agreement.
// You may redistribute and use this code without modification,
// provided you adhere to the terms of the MLA and include this
// copyright notice.
//
// See use restrictions at http://www.esri.com/legal/pdfs/mla_e204_e300/english
//
// For additional information, contact:
// Environmental Systems Research Institute, Inc.
// Attn: Contracts and Legal Services Department
// 380 New York Street
// Redlands, California, USA 92373
// USA
//
// email: contracts@esri.com
//
// See http://js.arcgis.com/4.11/esri/copyright.txt for details.

define(["require","exports","../../core/tsSupport/assignHelper"],function(t,e,i){function n(t,e,i,n){return void 0===i&&(i=32774),void 0===n&&(n=[0,0,0,0]),{srcRgb:t,srcAlpha:t,dstRgb:e,dstAlpha:e,opRgb:i,opAlpha:i,color:{r:n[0],g:n[1],b:n[2],a:n[3]}}}function s(t,e,i,n,s,l,r){return void 0===s&&(s=32774),void 0===l&&(l=32774),void 0===r&&(r=[0,0,0,0]),{srcRgb:t,srcAlpha:e,dstRgb:i,dstAlpha:n,opRgb:s,opAlpha:l,color:{r:r[0],g:r[1],b:r[2],a:r[3]}}}function l(t){return k.intern(t)}function r(t){return O.intern(t)}function o(t){return P.intern(t)}function a(t){return C.intern(t)}function p(t){return D.intern(t)}function u(t){return R.intern(t)}function h(t){return w.intern(t)}function c(t){return A.intern(t)}function d(t){return B.intern(t)}function f(t){return"["+t.join(",")+"]"}function _(t){return t?f([t.srcRgb,t.srcAlpha,t.dstRgb,t.dstAlpha,t.opRgb,t.opAlpha,t.color.r,t.color.g,t.color.b,t.color.a]):null}function g(t){return t?f([t.face,t.mode]):null}function v(t){return t?f([t.factor,t.units]):null}function W(t){return t?f([t.func]):null}function I(t){return t?f([t.function.func,t.function.ref,t.function.mask,t.operation.fail,t.operation.zFail,t.operation.zPass]):null}function S(t){return t?f([t.zNear,t.zFar]):null}function y(t){return t?f([t.r,t.g,t.b,t.a]):null}function b(t){return t?f([t.mask]):null}function T(t){return t?f([_(t.blending),g(t.culling),v(t.polygonOffset),W(t.depthTest),I(t.stencilTest),S(t.depthWrite),y(t.colorWrite),b(t.stencilWrite)]):null}Object.defineProperty(e,"__esModule",{value:!0}),e.simpleBlendingParams=n,e.separateBlendingParams=s,e.backFaceCullingParams={face:1029,mode:2305},e.defaultDepthWriteParams={zNear:0,zFar:1},e.defaultColorWriteParams={r:!0,g:!0,b:!0,a:!0},e.makeBlending=l,e.makeCulling=r,e.makePolygonOffset=o,e.makeDepthTest=a,e.makeStencilTest=p,e.makeDepthWrite=u,e.makeColorWrite=h,e.makeStencilWrite=c,e.makePipelineState=d;var m=function(){function t(t,e){this.makeKey=t,this.makeRef=e,this.interns=new Map}return t.prototype.intern=function(t){if(!t)return null;var e=this.makeKey(t),i=this.interns;return i.has(e)||i.set(e,this.makeRef(t)),i.get(e)},t}(),k=new m(_,function(t){return i({__tag:"Blending"},t)}),O=new m(g,function(t){return i({__tag:"Culling"},t)}),P=new m(v,function(t){return i({__tag:"PolygonOffset"},t)}),C=new m(W,function(t){return i({__tag:"DepthTest"},t)}),D=new m(I,function(t){return i({__tag:"StencilTest"},t)}),R=new m(S,function(t){return i({__tag:"DepthWrite"},t)}),w=new m(y,function(t){return i({__tag:"ColorWrite"},t)}),A=new m(b,function(t){return i({__tag:"StencilWrite"},t)}),B=new m(T,function(t){return{blending:l(t.blending),culling:r(t.culling),polygonOffset:o(t.polygonOffset),depthTest:a(t.depthTest),stencilTest:p(t.stencilTest),depthWrite:u(t.depthWrite),colorWrite:h(t.colorWrite),stencilWrite:c(t.stencilWrite)}}),z=function(){function t(t){this._pipelineInvalid=!0,this._blendingInvalid=!0,this._cullingInvalid=!0,this._polygonOffsetInvalid=!0,this._depthTestInvalid=!0,this._stencilTestInvalid=!0,this._depthWriteInvalid=!0,this._colorWriteInvalid=!0,this._stencilWriteInvalid=!0,this._stateSetters=t}return t.prototype.setPipeline=function(t){(this._pipelineInvalid||t!==this._pipeline)&&(this.setBlending(t.blending),this.setCulling(t.culling),this.setPolygonOffset(t.polygonOffset),this.setDepthTest(t.depthTest),this.setStencilTest(t.stencilTest),this.setDepthWrite(t.depthWrite),this.setColorWrite(t.colorWrite),this.setStencilWrite(t.stencilWrite),this._pipeline=t),this._pipelineInvalid=!1},t.prototype.invalidateBlending=function(){this._blendingInvalid=!0,this._pipelineInvalid=!0},t.prototype.invalidateCulling=function(){this._cullingInvalid=!0,this._pipelineInvalid=!0},t.prototype.invalidatePolygonOffset=function(){this._polygonOffsetInvalid=!0,this._pipelineInvalid=!0},t.prototype.invalidateDepthTest=function(){this._depthTestInvalid=!0,this._pipelineInvalid=!0},t.prototype.invalidateStencilTest=function(){this._stencilTestInvalid=!0,this._pipelineInvalid=!0},t.prototype.invalidateDepthWrite=function(){this._depthWriteInvalid=!0,this._pipelineInvalid=!0},t.prototype.invalidateColorWrite=function(){this._colorWriteInvalid=!0,this._pipelineInvalid=!0},t.prototype.invalidateStencilWrite=function(){this._stencilTestInvalid=!0,this._pipelineInvalid=!0},t.prototype.setBlending=function(t){this._blending=this.setSubState(t,this._blending,this._blendingInvalid,this._stateSetters.setBlending),this._blendingInvalid=!1},t.prototype.setCulling=function(t){this._culling=this.setSubState(t,this._culling,this._cullingInvalid,this._stateSetters.setCulling),this._cullingInvalid=!1},t.prototype.setPolygonOffset=function(t){this._polygonOffset=this.setSubState(t,this._polygonOffset,this._polygonOffsetInvalid,this._stateSetters.setPolygonOffset),this._polygonOffsetInvalid=!1},t.prototype.setDepthTest=function(t){this._depthTest=this.setSubState(t,this._depthTest,this._depthTestInvalid,this._stateSetters.setDepthTest),this._depthTestInvalid=!1},t.prototype.setStencilTest=function(t){this._stencilTest=this.setSubState(t,this._stencilTest,this._stencilTestInvalid,this._stateSetters.setStencilTest),this._stencilTestInvalid=!1},t.prototype.setDepthWrite=function(t){this._depthWrite=this.setSubState(t,this._depthWrite,this._depthWriteInvalid,this._stateSetters.setDepthWrite),this._depthWriteInvalid=!1},t.prototype.setColorWrite=function(t){this._colorWrite=this.setSubState(t,this._colorWrite,this._colorWriteInvalid,this._stateSetters.setColorWrite),this._colorWriteInvalid=!1},t.prototype.setStencilWrite=function(t){this._stencilWrite=this.setSubState(t,this._stencilWrite,this._stencilWriteInvalid,this._stateSetters.setStencilWrite),this._stencilTestInvalid=!1},t.prototype.setSubState=function(t,e,i,n){return(i||t!==e)&&(n(t),this._pipelineInvalid=!0),t},t}();e.StateTracker=z});