// COPYRIGHT Â© 2018 Esri
//
// All rights reserved under the copyright laws of the United States
// and applicable international laws, treaties, and conventions.
//
// This material is licensed for use under the Esri Master License
// Agreement (MLA), and is bound by the terms of that agreement.
// You may redistribute and use this code without modification,
// provided you adhere to the terms of the MLA and include this
// copyright notice.
//
// See use restrictions at http://www.esri.com/legal/pdfs/mla_e204_e300/english
//
// For additional information, contact:
// Environmental Systems Research Institute, Inc.
// Attn: Contracts and Legal Services Department
// 380 New York Street
// Redlands, California, USA 92373
// USA
//
// email: contracts@esri.com
//
// See http://js.arcgis.com/4.11/esri/copyright.txt for details.

define(["require","exports","./jsonUtils"],function(n,t,r){function e(n){return n&&"upperLeft"===n.originPosition}function u(n){return n?{originPosition:"upperLeft",scale:[n.tolerance,n.tolerance],translate:[n.extent.xmin,n.extent.ymax]}:null}function a(n,t){if(n===t||null==n&&null==t)return!0;if(null==n||null==t)return!1;var r,u,a,i,o,l;return e(n)?(r=n.translate[0],u=n.translate[1],a=n.scale[0]):(r=n.extent.xmin,u=n.extent.ymax,a=n.tolerance),e(t)?(i=t.translate[0],o=t.translate[1],l=t.scale[0]):(i=t.extent.xmin,o=t.extent.ymax,l=t.tolerance),r===i&&u===o&&a===l}function i(n,t){var r=n.scale,e=n.translate;return Math.round((t-e[0])/r[0])}function o(n,t){var r=n.scale,e=n.translate;return Math.round((e[1]-t)/r[1])}function l(n,t,r){for(var e,u,a,l,m=[],s=0;s<r.length;s++){var f=r[s];s>0?(a=i(n,f[0]),l=o(n,f[1]),a===e&&l===u||(m.push(t(f,a-e,l-u)),e=a,u=l)):(e=i(n,f[0]),u=o(n,f[1]),m.push(t(f,e,u)))}return m.length>0?m:null}function m(n,t,r){return t[0]=i(n,r[0]),t[3]=o(n,r[1]),t[2]=i(n,r[2]),t[1]=o(n,r[3]),t}function s(n,t,r,e){return l(n,r?e?R:O:e?O:G,t)}function f(n,t,r,e){for(var u=[],a=r?e?R:O:e?O:G,i=0;i<t.length;i++){var o=l(n,a,t[i]);o&&o.length>=3&&u.push(o)}return u.length?u:null}function c(n,t,r,e){for(var u=[],a=r?e?R:O:e?O:G,i=0;i<t.length;i++){var o=l(n,a,t[i]);o&&o.length>=2&&u.push(o)}return u.length?u:null}function h(n,t){var r=n.scale,e=n.translate;return t*r[0]+e[0]}function x(n,t){var r=n.scale;return n.translate[1]-t*r[1]}function y(n,t,r){var e=new Array(r.length);if(!r.length)return e;var u=n.scale,a=u[0],i=u[1],o=h(n,r[0][0]),l=x(n,r[0][1]);e[0]=t(r[0],o,l);for(var m=1;m<r.length;m++){var s=r[m];o+=s[0]*a,l-=s[1]*i,e[m]=t(s,o,l)}return e}function d(n,t,r){for(var e=new Array(r.length),u=0;u<r.length;u++)e[u]=y(n,t,r[u]);return e}function g(n,t,r){return r?(t[0]=h(n,r[0]),t[1]=x(n,r[3]),t[2]=h(n,r[2]),t[3]=x(n,r[1]),t):[h(n,t[0]),x(n,t[3]),h(n,t[2]),x(n,t[1])]}function z(n,t,r,e){return y(n,r?e?R:O:e?O:G,t)}function I(n,t,r,e){return d(n,r?e?R:O:e?O:G,t)}function v(n,t,r,e){return d(n,r?e?R:O:e?O:G,t)}function p(n,t,r){for(var e=r[0],u=e[0],a=e[1],i=Math.min(u,t[0]),o=Math.min(a,t[1]),l=Math.max(u,t[2]),m=Math.max(a,t[3]),s=1;s<r.length;s++){var f=r[s],c=f[0],h=f[1];u+=c,a+=h,c<0&&(i=Math.min(i,u)),c>0&&(l=Math.max(l,u)),h<0?o=Math.min(o,a):h>0&&(m=Math.max(m,a))}return n[0]=i,n[1]=o,n[2]=l,n[3]=m,n}function N(n,t){if(!t.length)return null;n[0]=n[1]=Number.POSITIVE_INFINITY,n[2]=n[3]=Number.NEGATIVE_INFINITY;for(var r=0;r<t.length;r++)p(n,n,t[r]);return n}function P(n){var t=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];return p(t,t,n)}function q(n){return N([0,0,0,0],n)}function M(n){return N([0,0,0,0],n)}function T(n,t,r,e,u){return t.xmin=i(n,r.xmin),t.ymin=o(n,r.ymin),t.xmax=i(n,r.xmax),t.ymax=o(n,r.ymax),t!==r&&(e&&(t.zmin=r.zmin,t.zmax=r.zmax),u&&(t.mmin=r.mmin,t.mmax=r.mmax)),t}function E(n,t,r,e,u){return t.points=s(n,r.points,e,u),t}function A(n,t,r,e,u){return t.x=i(n,r.x),t.y=o(n,r.y),t!==r&&(e&&(t.z=r.z),u&&(t.m=r.m)),t}function Y(n,t,r,e,u){var a=f(n,r.rings,e,u);return a?(t.rings=a,t):null}function _(n,t,r,e,u){var a=c(n,r.paths,e,u);return a?(t.paths=a,t):null}function b(n,t){return n&&t?r.isPoint(t)?A(n,{},t,!1,!1):r.isPolyline(t)?_(n,{},t,!1,!1):r.isPolygon(t)?Y(n,{},t,!1,!1):r.isMultipoint(t)?E(n,{},t,!1,!1):r.isExtent(t)?T(n,{},t,!1,!1):null:null}function B(n,t,r,e,u){return t.xmin=h(n,r.xmin),t.ymin=x(n,r.ymin),t.xmax=h(n,r.xmax),t.ymax=x(n,r.ymax),t!==r&&(e&&(t.zmin=r.zmin,t.zmax=r.zmax),u&&(t.mmin=r.mmin,t.mmax=r.mmax)),t}function F(n,t,r,e,u){return t.points=z(n,r.points,e,u),t}function Q(n,t,r,e,u){return t.x=h(n,r.x),t.y=x(n,r.y),t!==r&&(e&&(t.z=r.z),u&&(t.m=r.m)),t}function V(n,t,r,e,u){return t.rings=v(n,r.rings,e,u),t}function C(n,t,r,e,u){return t.paths=I(n,r.paths,e,u),t}Object.defineProperty(t,"__esModule",{value:!0});var G=function(n,t,r){return[t,r]},O=function(n,t,r){return[t,r,n[2]]},R=function(n,t,r){return[t,r,n[2],n[3]]};t.toQuantizationTransform=u,t.equals=a,t.quantizeX=i,t.quantizeY=o,t.quantizeBounds=m,t.quantizePoints=s,t.quantizeRings=f,t.quantizePaths=c,t.hydrateX=h,t.hydrateY=x,t.hydrateCoordsArray=y,t.hydrateCoordsArrayArray=d,t.hydrateBounds=g,t.hydratePoints=z,t.hydratePaths=I,t.hydrateRings=v,t.getQuantizedBoundsCoordsArray=p,t.getQuantizedBoundsCoordsArrayArray=N,t.getQuantizedBoundsPoints=P,t.getQuantizedBoundsPaths=q,t.getQuantizedBoundsRings=M,t.quantizeExtent=T,t.quantizeMultipoint=E,t.quantizePoint=A,t.quantizePolygon=Y,t.quantizePolyline=_,t.quantizeGeometry=b,t.hydrateExtent=B,t.hydrateMultipoint=F,t.hydratePoint=Q,t.hydratePolygon=V,t.hydratePolyline=C});