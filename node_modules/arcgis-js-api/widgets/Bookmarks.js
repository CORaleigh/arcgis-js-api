// COPYRIGHT Â© 2018 Esri
//
// All rights reserved under the copyright laws of the United States
// and applicable international laws, treaties, and conventions.
//
// This material is licensed for use under the Esri Master License
// Agreement (MLA), and is bound by the terms of that agreement.
// You may redistribute and use this code without modification,
// provided you adhere to the terms of the MLA and include this
// copyright notice.
//
// See use restrictions at http://www.esri.com/legal/pdfs/mla_e204_e300/english
//
// For additional information, contact:
// Environmental Systems Research Institute, Inc.
// Attn: Contracts and Legal Services Department
// 380 New York Street
// Redlands, California, USA 92373
// USA
//
// email: contracts@esri.com
//
// See http://js.arcgis.com/4.11/esri/copyright.txt for details.

define(["require","exports","../core/tsSupport/declareExtendsHelper","../core/tsSupport/decorateHelper","dojo/i18n!./Bookmarks/nls/Bookmarks","../core/Handles","../core/watchUtils","../core/accessorSupport/decorators","./Widget","./Bookmarks/BookmarksViewModel","./support/widget"],function(o,e,r,a,s,i,t,n,k,d,l){var m={base:"esri-bookmarks esri-widget--panel",loaderContainer:"esri-bookmarks__loader-container",loader:"esri-bookmarks__loader",fadeIn:"esri-bookmarks--fade-in",bookmarkList:"esri-bookmarks__list",bookmark:"esri-bookmarks__bookmark",bookmarkContainer:"esri-bookmarks__bookmark-container",bookmarkIcon:"esri-bookmarks__bookmark-icon",bookmarkImage:"esri-bookmarks__image",bookmarkName:"esri-bookmarks__bookmark-name",bookmarkActive:"esri-bookmarks__bookmark--active",noBookmarksContainer:"esri-widget__content--empty",noBookmarksHeader:"esri-bookmarks__no-bookmarks-heading",noBookmarksImage:"esri-widget__content-icon--empty",noBookmarksDescription:"esri-bookmarks__no-bookmarks-description",disabledContainer:"esri-bookmarks__disabled-container",disabledHeading:"esri-bookmarks__disabled-heading",disabledDescription:"esri-bookmarks__disabled-description",esriWidget:"esri-widget",widgetIcon:"esri-icon-bookmark",header:"esri-widget__heading",disabled:"esri-disabled"};return function(o){function e(e){var r=o.call(this)||this;return r._handles=new i,r.bookmarks=null,r.goToOverride=null,r.iconClass=m.widgetIcon,r.label=s.widgetLabel,r.view=null,r.viewModel=new d,r}return r(e,o),e.prototype.postInitialize=function(){var o=this;this.own([t.on(this,"viewModel.bookmarks","change",function(){return o._bookmarksChanged()}),t.init(this,"viewModel.bookmarks",function(){return o._bookmarksChanged()})])},e.prototype.destroy=function(){this._handles.destroy(),this._handles=null},e.prototype.goTo=function(o){return null},e.prototype.render=function(){var o,e=this.viewModel.state,r="disabled"===e?this._renderDisabled():"loading"===e?this._renderLoading():this._renderBookmarks(),a=(o={},o[m.disabled]="disabled"===e,o);return l.tsx("div",{class:this.classes(a,m.base,m.esriWidget)},r)},e.prototype._renderLoading=function(){return l.tsx("div",{class:m.loaderContainer,key:"loader"},l.tsx("div",{class:m.loader}))},e.prototype._renderDisabled=function(){return l.tsx("div",{key:"bookmarks-disabled",class:this.classes(m.noBookmarksContainer,m.disabledContainer)},l.tsx("h1",{class:m.header},s.disabledHeading),l.tsx("p",{class:m.disabledDescription},s.disabledDescription))},e.prototype._renderNoBookmarksContainer=function(){return l.tsx("div",{class:m.noBookmarksContainer,key:"no-bookmarks"},l.tsx("svg",{class:m.noBookmarksImage,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32"},l.tsx("path",{fill:"currentColor",d:"M26 30.435L16.5 24.1 7 30.435V1h19zm-9.5-7.536l8.5 5.666V2H8v26.565z"})),l.tsx("h1",{class:this.classes(m.header,m.noBookmarksHeader)},s.noBookmarksHeading),l.tsx("p",{class:m.noBookmarksDescription},s.noBookmarksDescription))},e.prototype._renderBookmarksContainer=function(o){var e=this;return l.tsx("ul",{key:"bookmark-list","aria-label":s.widgetLabel,class:m.bookmarkList},o.map(function(o){return e._renderBookmark(o)}).toArray())},e.prototype._renderBookmarks=function(){var o=this.viewModel.bookmarks,e=o.filter(Boolean);return e.length?this._renderBookmarksContainer(e):this._renderNoBookmarksContainer()},e.prototype._renderBookmark=function(o){var e,r=this.viewModel.activeBookmark,a=o.name,i=o.thumbnail,t=(e={},e[m.bookmarkActive]=r===o,e),n=i&&i.url||"",k=n?l.tsx("div",{class:m.bookmarkContainer},l.tsx("img",{src:n,alt:a,class:m.bookmarkImage})):l.tsx("span",{"aria-hidden":"true",class:this.classes(m.bookmarkIcon,m.widgetIcon)});return l.tsx("li",{bind:this,"data-bookmark-item":o,class:this.classes(m.bookmark,t),onclick:this._goToBookmark,onkeydown:this._goToBookmark,tabIndex:0,role:"button",title:s.goToBookmark,"aria-label":a},k,l.tsx("span",{class:m.bookmarkName},a))},e.prototype._bookmarksChanged=function(){var o=this,e=this.viewModel.bookmarks,r=this._handles;r.remove("items");var a=e.map(function(e){return t.watch(e,["active","name","thumbnail.url"],function(){return o.scheduleRender()})});r.add(a,"items"),this.scheduleRender()},e.prototype._goToBookmark=function(o){var e=o.currentTarget,r=e["data-bookmark-item"];this.viewModel.goTo(r)},a([n.aliasOf("viewModel.bookmarks")],e.prototype,"bookmarks",void 0),a([n.aliasOf("viewModel.goToOverride")],e.prototype,"goToOverride",void 0),a([n.property()],e.prototype,"iconClass",void 0),a([n.property()],e.prototype,"label",void 0),a([n.aliasOf("viewModel.view")],e.prototype,"view",void 0),a([n.property({type:d}),l.renderable(["activeBookmark","state"]),l.vmEvent(["select-bookmark"])],e.prototype,"viewModel",void 0),a([n.aliasOf("viewModel.goTo")],e.prototype,"goTo",null),a([l.accessibleHandler()],e.prototype,"_goToBookmark",null),e=a([n.subclass("esri.widgets.Bookmarks")],e)}(n.declared(k))});