{"version":3,"file":"localStorage.js","sourceRoot":"","sources":["localStorage.ts"],"names":[],"mappings":";;;;;;;;;;;IAAA,4CAAuC;IACvC,sCAA2F;IAG3F,kDAA0C;IAE1C,mBAAmC,EAAU,EAAE,QAAqB;QACnE,MAAM,CAAC,cAAM,OAAA,CAAC;YACb,KAAK,EAAE,UAAC,KAA0B,EAAE,MAAqB;gBACxD,IAAM,KAAK,GAAG,QAAQ,CAAC,MAAM,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;gBAC1C,IAAM,IAAI,GAAG,KAAK,CAAC,GAAG,CAAC,UAAC,IAAI;oBAC3B,IAAM,KAAK,GAAG,MAAM,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC;oBAC/B,MAAM,CAAC,EAAE,IAAI,EAAE,EAAE,IAAI,EAAE,IAAI,CAAC,IAAI,EAAE,EAAE,KAAK,OAAA,EAAE,CAAC;gBAC7C,CAAC,CAAC,CAAC;gBACH,gBAAM,CAAC,YAAY,CAAC,OAAO,CAAC,EAAE,EAAE,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,CAAC,CAAC;YACvD,CAAC;SACD,CAAC,EATW,CASX,CAAC;IACJ,CAAC;IAXD,8BAWC;IAED,cAAwB,EAAU,EAAE,KAAe;QAClD,IAAI,IAAI,GAAG,gBAAM,CAAC,YAAY,CAAC,OAAO,CAAC,EAAE,CAAC,CAAC;QAC3C,EAAE,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC;YACV,IAAI,CAAC;gBACJ,IAAM,UAAU,GAAU,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;gBAC3C,IAAM,YAAU,GAAG,UAAU,CAAC,GAAG,CAAC,UAAC,IAAI;oBACtC,MAAM,CAAC,gBAAG,CAAC,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE,IAAI,CAAC,KAAK,CAAC,CAAC;gBACpD,CAAC,CAAC,CAAC;gBACH,yBAAe,CAAC,oBAAoB,EAAE,CAAC,cAAM,OAAA,YAAU,EAAV,CAAU,CAAC,EAAE,KAAK,EAAE,SAAS,EAAE,SAAS,EAAE,SAAS,CAAC,CAAC,EAAE,CAAC,CAAC;YACvG,CAAC;YAAC,KAAK,CAAC,CAAC,IAAD,CAAC;gBACR,cAAc;YACf,CAAC;QACF,CAAC;IACF,CAAC;IAbD,oBAaC","sourcesContent":["import global from '../../shim/global';\nimport { ProcessError, ProcessResult, ProcessCallback, processExecutor } from '../process';\nimport { Store } from '../Store';\nimport { GetPaths } from '../StoreProvider';\nimport { add } from '../state/operations';\n\nexport function collector<T = any>(id: string, getPaths: GetPaths<T>): ProcessCallback {\n\treturn () => ({\n\t\tafter: (error: ProcessError | null, result: ProcessResult): void => {\n\t\t\tconst paths = getPaths(result.store.path);\n\t\t\tconst data = paths.map((path) => {\n\t\t\t\tconst state = result.get(path);\n\t\t\t\treturn { meta: { path: path.path }, state };\n\t\t\t});\n\t\t\tglobal.localStorage.setItem(id, JSON.stringify(data));\n\t\t}\n\t});\n}\n\nexport function load<T>(id: string, store: Store<T>) {\n\tlet data = global.localStorage.getItem(id);\n\tif (data) {\n\t\ttry {\n\t\t\tconst parsedData: any[] = JSON.parse(data);\n\t\t\tconst operations = parsedData.map((item) => {\n\t\t\t\treturn add(store.path(item.meta.path), item.state);\n\t\t\t});\n\t\t\tprocessExecutor('local-storage-load', [() => operations], store, undefined, undefined, undefined)({});\n\t\t} catch {\n\t\t\t// do nothing?\n\t\t}\n\t}\n}\n"]}