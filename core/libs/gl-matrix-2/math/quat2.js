// COPYRIGHT Â© 2018 Esri
//
// All rights reserved under the copyright laws of the United States
// and applicable international laws, treaties, and conventions.
//
// This material is licensed for use under the Esri Master License
// Agreement (MLA), and is bound by the terms of that agreement.
// You may redistribute and use this code without modification,
// provided you adhere to the terms of the MLA and include this
// copyright notice.
//
// See use restrictions at http://www.esri.com/legal/pdfs/mla_e204_e300/english
//
// For additional information, contact:
// Environmental Systems Research Institute, Inc.
// Attn: Contracts and Legal Services Department
// 380 New York Street
// Redlands, California, USA 92373
// USA
//
// email: contracts@esri.com
//
// See http://js.arcgis.com/4.11/esri/copyright.txt for details.

define(["require","exports","../factories/quatf64","../factories/vec3f64","./common","./mat4","./quat"],function(t,a,n,r,e,u,o){function s(t,a,n){var r=.5*n[0],e=.5*n[1],u=.5*n[2],o=a[0],s=a[1],i=a[2],h=a[3];return t[0]=o,t[1]=s,t[2]=i,t[3]=h,t[4]=r*h+e*i-u*s,t[5]=e*h+u*o-r*i,t[6]=u*h+r*s-e*o,t[7]=-r*o-e*s-u*i,t}function i(t,a){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t[4]=.5*a[0],t[5]=.5*a[1],t[6]=.5*a[2],t[7]=0,t}function h(t,a){return t[0]=a[0],t[1]=a[1],t[2]=a[2],t[3]=a[3],t[4]=0,t[5]=0,t[6]=0,t[7]=0,t}function c(t,a){var n=B;u.getRotation(n,a);var r=D;return u.getTranslation(r,a),s(t,n,r),t}function f(t,a){return t[0]=a[0],t[1]=a[1],t[2]=a[2],t[3]=a[3],t[4]=a[4],t[5]=a[5],t[6]=a[6],t[7]=a[7],t}function M(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t[6]=0,t[7]=0,t}function b(t,a,n,r,e,u,o,s,i){return t[0]=a,t[1]=n,t[2]=r,t[3]=e,t[4]=u,t[5]=o,t[6]=s,t[7]=i,t}function l(t,a){return t[0]=a[4],t[1]=a[5],t[2]=a[6],t[3]=a[7],t}function v(t,a){return t[4]=a[0],t[5]=a[1],t[6]=a[2],t[7]=a[3],t}function m(t,a){var n=a[4],r=a[5],e=a[6],u=a[7],o=-a[0],s=-a[1],i=-a[2],h=a[3];return t[0]=2*(n*h+u*o+r*i-e*s),t[1]=2*(r*h+u*s+e*o-n*i),t[2]=2*(e*h+u*i+n*s-r*o),t}function d(t,a,n){var r=a[0],e=a[1],u=a[2],o=a[3],s=.5*n[0],i=.5*n[1],h=.5*n[2],c=a[4],f=a[5],M=a[6],b=a[7];return t[0]=r,t[1]=e,t[2]=u,t[3]=o,t[4]=o*s+e*h-u*i+c,t[5]=o*i+u*s-r*h+f,t[6]=o*h+r*i-e*s+M,t[7]=-r*s-e*i-u*h+b,t}function L(t,a,n){var r=-a[0],e=-a[1],u=-a[2],s=a[3],i=a[4],h=a[5],c=a[6],f=a[7],M=i*s+f*r+h*u-c*e,b=h*s+f*e+c*r-i*u,l=c*s+f*u+i*e-h*r,v=f*s-i*r-h*e-c*u;return o.rotateX(t,a,n),r=t[0],e=t[1],u=t[2],s=t[3],t[4]=M*s+v*r+b*u-l*e,t[5]=b*s+v*e+l*r-M*u,t[6]=l*s+v*u+M*e-b*r,t[7]=v*s-M*r-b*e-l*u,t}function g(t,a,n){var r=-a[0],e=-a[1],u=-a[2],s=a[3],i=a[4],h=a[5],c=a[6],f=a[7],M=i*s+f*r+h*u-c*e,b=h*s+f*e+c*r-i*u,l=c*s+f*u+i*e-h*r,v=f*s-i*r-h*e-c*u;return o.rotateY(t,a,n),r=t[0],e=t[1],u=t[2],s=t[3],t[4]=M*s+v*r+b*u-l*e,t[5]=b*s+v*e+l*r-M*u,t[6]=l*s+v*u+M*e-b*r,t[7]=v*s-M*r-b*e-l*u,t}function q(t,a,n){var r=-a[0],e=-a[1],u=-a[2],s=a[3],i=a[4],h=a[5],c=a[6],f=a[7],M=i*s+f*r+h*u-c*e,b=h*s+f*e+c*r-i*u,l=c*s+f*u+i*e-h*r,v=f*s-i*r-h*e-c*u;return o.rotateZ(t,a,n),r=t[0],e=t[1],u=t[2],s=t[3],t[4]=M*s+v*r+b*u-l*e,t[5]=b*s+v*e+l*r-M*u,t[6]=l*s+v*u+M*e-b*r,t[7]=v*s-M*r-b*e-l*u,t}function x(t,a,n){var r=n[0],e=n[1],u=n[2],o=n[3],s=a[0],i=a[1],h=a[2],c=a[3];return t[0]=s*o+c*r+i*u-h*e,t[1]=i*o+c*e+h*r-s*u,t[2]=h*o+c*u+s*e-i*r,t[3]=c*o-s*r-i*e-h*u,s=a[4],i=a[5],h=a[6],c=a[7],t[4]=s*o+c*r+i*u-h*e,t[5]=i*o+c*e+h*r-s*u,t[6]=h*o+c*u+s*e-i*r,t[7]=c*o-s*r-i*e-h*u,t}function P(t,a,n){var r=a[0],e=a[1],u=a[2],o=a[3],s=n[0],i=n[1],h=n[2],c=n[3];return t[0]=r*c+o*s+e*h-u*i,t[1]=e*c+o*i+u*s-r*h,t[2]=u*c+o*h+r*i-e*s,t[3]=o*c-r*s-e*i-u*h,s=n[4],i=n[5],h=n[6],c=n[7],t[4]=r*c+o*s+e*h-u*i,t[5]=e*c+o*i+u*s-r*h,t[6]=u*c+o*h+r*i-e*s,t[7]=o*c-r*s-e*i-u*h,t}function p(t,a,n,r){if(Math.abs(r)<e.EPSILON)return f(t,a);var u=Math.sqrt(n[0]*n[0]+n[1]*n[1]+n[2]*n[2]);r*=.5;var o=Math.sin(r),s=o*n[0]/u,i=o*n[1]/u,h=o*n[2]/u,c=Math.cos(r),M=a[0],b=a[1],l=a[2],v=a[3];t[0]=M*c+v*s+b*h-l*i,t[1]=b*c+v*i+l*s-M*h,t[2]=l*c+v*h+M*i-b*s,t[3]=v*c-M*s-b*i-l*h;var m=a[4],d=a[5],L=a[6],g=a[7];return t[4]=m*c+g*s+d*h-L*i,t[5]=d*c+g*i+L*s-m*h,t[6]=L*c+g*h+m*i-d*s,t[7]=g*c-m*s-d*i-L*h,t}function E(t,a,n){return t[0]=a[0]+n[0],t[1]=a[1]+n[1],t[2]=a[2]+n[2],t[3]=a[3]+n[3],t[4]=a[4]+n[4],t[5]=a[5]+n[5],t[6]=a[6]+n[6],t[7]=a[7]+n[7],t}function O(t,a,n){var r=a[0],e=a[1],u=a[2],o=a[3],s=n[4],i=n[5],h=n[6],c=n[7],f=a[4],M=a[5],b=a[6],l=a[7],v=n[0],m=n[1],d=n[2],L=n[3];return t[0]=r*L+o*v+e*d-u*m,t[1]=e*L+o*m+u*v-r*d,t[2]=u*L+o*d+r*m-e*v,t[3]=o*L-r*v-e*m-u*d,t[4]=r*c+o*s+e*h-u*i+f*L+l*v+M*d-b*m,t[5]=e*c+o*i+u*s-r*h+M*L+l*m+b*v-f*d,t[6]=u*c+o*h+r*i-e*s+b*L+l*d+f*m-M*v,t[7]=o*c-r*s-e*i-u*h+l*L-f*v-M*m-b*d,t}function I(t,a,n){return t[0]=a[0]*n,t[1]=a[1]*n,t[2]=a[2]*n,t[3]=a[3]*n,t[4]=a[4]*n,t[5]=a[5]*n,t[6]=a[6]*n,t[7]=a[7]*n,t}function N(t,n,r,e){var u=1-e;return a.dot(n,r)<0&&(e=-e),t[0]=n[0]*u+r[0]*e,t[1]=n[1]*u+r[1]*e,t[2]=n[2]*u+r[2]*e,t[3]=n[3]*u+r[3]*e,t[4]=n[4]*u+r[4]*e,t[5]=n[5]*u+r[5]*e,t[6]=n[6]*u+r[6]*e,t[7]=n[7]*u+r[7]*e,t}function S(t,n){var r=a.squaredLength(n);return t[0]=-n[0]/r,t[1]=-n[1]/r,t[2]=-n[2]/r,t[3]=n[3]/r,t[4]=-n[4]/r,t[5]=-n[5]/r,t[6]=-n[6]/r,t[7]=n[7]/r,t}function y(t,a){return t[0]=-a[0],t[1]=-a[1],t[2]=-a[2],t[3]=a[3],t[4]=-a[4],t[5]=-a[5],t[6]=-a[6],t[7]=a[7],t}function R(t,n){var r=a.squaredLength(n);if(r>0){r=Math.sqrt(r);var e=n[0]/r,u=n[1]/r,o=n[2]/r,s=n[3]/r,i=n[4],h=n[5],c=n[6],f=n[7],M=e*i+u*h+o*c+s*f;t[0]=e,t[1]=u,t[2]=o,t[3]=s,t[4]=(i-e*M)/r,t[5]=(h-u*M)/r,t[6]=(c-o*M)/r,t[7]=(f-s*M)/r}return t}function T(t){return"quat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+")"}function A(t,a){return t[0]===a[0]&&t[1]===a[1]&&t[2]===a[2]&&t[3]===a[3]&&t[4]===a[4]&&t[5]===a[5]&&t[6]===a[6]&&t[7]===a[7]}function j(t,a){var n=t[0],r=t[1],u=t[2],o=t[3],s=t[4],i=t[5],h=t[6],c=t[7],f=a[0],M=a[1],b=a[2],l=a[3],v=a[4],m=a[5],d=a[6],L=a[7];return Math.abs(n-f)<=e.EPSILON*Math.max(1,Math.abs(n),Math.abs(f))&&Math.abs(r-M)<=e.EPSILON*Math.max(1,Math.abs(r),Math.abs(M))&&Math.abs(u-b)<=e.EPSILON*Math.max(1,Math.abs(u),Math.abs(b))&&Math.abs(o-l)<=e.EPSILON*Math.max(1,Math.abs(o),Math.abs(l))&&Math.abs(s-v)<=e.EPSILON*Math.max(1,Math.abs(s),Math.abs(v))&&Math.abs(i-m)<=e.EPSILON*Math.max(1,Math.abs(i),Math.abs(m))&&Math.abs(h-d)<=e.EPSILON*Math.max(1,Math.abs(h),Math.abs(d))&&Math.abs(c-L)<=e.EPSILON*Math.max(1,Math.abs(c),Math.abs(L))}Object.defineProperty(a,"__esModule",{value:!0}),a.fromRotationTranslation=s,a.fromTranslation=i,a.fromRotation=h,a.fromMat4=c;var B=n.create(),D=r.create();a.copy=f,a.identity=M,a.set=b,a.getReal=o.copy,a.getDual=l,a.setReal=o.copy,a.setDual=v,a.getTranslation=m,a.translate=d,a.rotateX=L,a.rotateY=g,a.rotateZ=q,a.rotateByQuatAppend=x,a.rotateByQuatPrepend=P,a.rotateAroundAxis=p,a.add=E,a.multiply=O,a.mul=O,a.scale=I,a.dot=o.dot,a.lerp=N,a.invert=S,a.conjugate=y,a.length=o.length,a.len=a.length,a.squaredLength=o.squaredLength,a.sqrLen=a.squaredLength,a.normalize=R,a.str=T,a.exactEquals=A,a.equals=j});